
<f:layout name="BE" />

<f:section name="content">    
    
    <div class="pxa-social-feed-be-config">
    
        <f:if condition="{tokens}">
            
            <f:then>                
                <div class ="js__pxasocialfeed-be-config-form" >
                    <h4><f:translate key='tx_pxasocialfeed_module.config.header1'> Add new config or edit existing </f:translate></h4>
                    <f:form action="addConfig" name="pxasocialfeed_form_config" controller="Feeds" enctype="multipart/form-data" noCache="1">

                        <table class="table table-bordered">
                            <tr>
                                <td><f:translate key='tx_pxasocialfeed_module.config.form.config_name'> Config name </f:translate></td>
                                <td><f:form.textfield name="configName"/></td>
                            </tr>
                            <tr>
                                <td><f:translate key='tx_pxasocialfeed_module.config.form.social_id'> Social ID </f:translate></td>
                                <td><f:form.textfield name="socialId"/></td>
                            </tr>
                            
                            <tr>
                                <td><f:translate key='tx_pxasocialfeed_module.config.form.pid_for_feeds'> Pid for feeds </f:translate></td>
                                <td><f:form.textfield name="feedPid"/></td>
                            </tr>
                            <tr>
                                <td><f:translate key='tx_pxasocialfeed_module.config.form.amount_of_feeds'> Count of feeds (that will be taken from social network) </f:translate></td>
                                <td><f:form.textfield name="feedCount"/></td>
                            </tr>
                            <tr>
                                <td><f:translate key='tx_pxasocialfeed_module.config.form.type'> Type </f:translate></td>
                                <td>
                                    <select name="tx_pxasocialfeed_tools_pxasocialfeedimporter[token]">
                                        <f:for each="{tokens}" as="token" iteration="index">
                                            <f:if condition="{index} == 1">
                                                <f:then>
                                                    <option selected="selected" value="{token.uid}">
                                                        {token.uid}
                                                        <f:render partial="Feeds/SelectType" arguments="{type: token.socialType}" />
                                                        <f:format.crop maxCharacters="7">{token.appId}</f:format.crop>
                                                    </option>
                                                </f:then>
                                                <f:else>
                                                    <option value="{token.uid}">
                                                        {token.uid}
                                                        <f:render partial="Feeds/SelectType" arguments="{type: token.socialType}" />
                                                        <f:format.crop maxCharacters="7">{token.appId}</f:format.crop>
                                                    </option>
                                                </f:else>
                                            </f:if>
                                        </f:for>
                                        
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <f:form.hidden name="configUid" value="0" />
                                    <f:form.hidden name="DeleteConfig" value="0" />
                                </td>

                                <td>
                                    <f:form.submit class="btn btn-success" name="save" value="<f:translate key='tx_pxasocialfeed_module.config.form.button_save'> Save Config </f:translate>"/>
                                    <input class="js__pxasocialfeed-be-config-form-clear-button btn btn-default" type="button" value="<f:translate key='tx_pxasocialfeed_module.config.form.button_clear'> Clear Table </f:translate>"/>
                                    <f:form.submit class="btn btn-danger" style="display: none;" name="delete" value="<f:translate key='tx_pxasocialfeed_module.config.form.button_delete'> Delete Config </f:translate>"/>   
                                </td>
                            </tr>
                        </table>                
                    </f:form>
                </div>	

                <div class="js__pxasocialfeed-be-show-all-configs">        
                    <f:if condition="{configs}">                
                        <f:then>
                            <h2><f:translate key='tx_pxasocialfeed_module.config.header2'> Available configs </f:translate></h2>
                            <div class="js__pxasocialfeed-be-configs">
                                <table class="table table-striped">

                                    <tr class="info">
                                        <td><f:translate key='tx_pxasocialfeed_module.config.table.uid'> uid </f:translate></td>
                                        <td><f:translate key='tx_pxasocialfeed_module.config.form.config_name'> Config name </f:translate></td>
                                        <td><f:translate key='tx_pxasocialfeed_module.config.form.social_id'> Social ID </f:translate></td>
                                        <td><f:translate key='tx_pxasocialfeed_module.config.table.pid'> Feed pid </f:translate></td>
                                        <td><f:translate key='tx_pxasocialfeed_module.config.table.feed_amount'> Amount of feeds </f:translate></td>
                                        <td><f:translate key='tx_pxasocialfeed_module.config.form.type'> Type </f:translate></td>
                                        <td><f:translate key='tx_pxasocialfeed_module.config.table.token_uid'> Token uid </f:translate></td>
                                        <td><f:translate key='tx_pxasocialfeed_module.token.form.app_id'> App ID </f:translate></td>
                                    </tr>

                                    <f:for each="{configs}" as="config">                                
                                        <tr class="js__pxasocialfeed-be-custom-config">
                                            <td>{config.uid}</td>
                                            <td>{config.configName}</td>
                                            <td>{config.socialId}</td>
                                            <td>{config.feedPid}</td>
                                            <td>{config.feedCount}</td>                              
                                            <td>
                                                <f:render partial="Feeds/SelectType" arguments="{type: config.token.socialType}" />                                                
                                            </td>
                                            <td>{config.token.uid}</td>
                                            <td>{config.token.appId}
                                                <input type="hidden" value="{config.token.uid}"/>
                                                <input type="hidden" value="{config.token.uid}"/>
                                            </td>
                                        </tr>                                
                                    </f:for>

                                </table> 
                            </div>
                        </f:then>
                        <f:else>
                            <h2> <f:translate key='tx_pxasocialfeed_module.config.header3'> There is no created config </f:translate></h2>
                        </f:else>
                    </f:if>
                </div>
                
            </f:then>
            <f:else>
                <h1 class="text-danger"> <f:translate key='tx_pxasocialfeed_module.config.header4'> CRETE TOKEN OBJECT FIRST !!! </f:translate></h1>
            </f:else>
            
        </f:if>
    </div>
        
</f:section>
